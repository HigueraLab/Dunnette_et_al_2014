
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Fig_3_script</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-04-10"><meta name="DC.source" content="Fig_3_script.m"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">Fig_3_script.m</a></li><li><a href="#2">Set working directories: directories where input data are located</a></li><li><a href="#3">Load data and create variables</a></li><li><a href="#4">Define variables from charcoal data</a></li><li><a href="#5">Define variables from MS data</a></li><li><a href="#6">Define "high severity catchment fires" (HSCF)</a></li><li><a href="#7">Create Figure</a></li></ul></div><h2>Fig_3_script.m<a name="1"></a></h2><p>Make Figure 3 from:   Dunnette P.V., P.E. Higuera, K.K. McLauchlan, K.M. Derr, C.E. Briles,   M.H. Keefe. 2014. Biogeochemical impacts of wildfires over four   millennia in a Rocky Mountain subalpine watershed.   New Phytologist Accepted.</p><p>Figure 3. Sediment charcoal and magnetic susceptibility (MS) records. (a) Charcoal accumulation rate (CHAR, black line), interpolated to 10-year intervals, and the 500-year trend (gray line), representing &#8220;background&#8221; CHAR. (b) Residual CHAR values (black line), the threshold used to identify potential fire events (red line), and CHAR values this threshold and thus identified as local fire events (red dots). (c) Residual MS values (gray line), the threshold used to identify MS peaks (red line), MS values exceeding the threshold and thus identified as MS peaks (grey circles), with coincident CHAR and MS peaks identified as high-severity catchment fires (grey circles with red dots).</p><p>FILE REQUIREMENTS:   (1) CH10_MS_charResults.csv -- results from CharAnalysis   (2) CH10_charResults.csv -- results form CharAnalysis, run with MS data</p><p>DEPENDENCIES:   NONE</p><p>CITATION, FILES, AND SELF-AUTHORED FUNCTIONS AVAILABLE FROM FigShare   Higuera, P.E. and P.V. Dunnette. 2014. Data, code, and   figures from Dunnette et al. 2014. figshare.   <a href="http://dx.doi.org/10.6084/m9.figshare.988687">http://dx.doi.org/10.6084/m9.figshare.988687</a></p><p>Created by: P.V. Dunnette Created on: December 2012 Updated: 2/2013; 7/2013; 8/2013; 9/2013; 11/2013; 1/2014 by PVD Edited: 4/2014 for publication, by P.E. Higuera.</p><p>University of Idaho, PaleoEcology and Fire Ecology Lab <a href="http://www.uidaho.edu/cnr/paleoecologylab">http://www.uidaho.edu/cnr/paleoecologylab</a> <a href="mailto:phiguera@uidaho.edu">phiguera@uidaho.edu</a></p><pre class="codeinput">clear <span class="string">all</span>
</pre><h2>Set working directories: directories where input data are located<a name="2"></a></h2><pre class="codeinput"><span class="comment">%%%% IF ALL FILES ARE LOCATED IN THE SAME DIRECTORY AS THIS SCRIPT, CHANGE</span>
<span class="comment">%%%% workdingDir to 'pwd'</span>
startDir = pwd;     <span class="comment">% Record starting path</span>
workingDir = <span class="string">'L:\4_archivedData\Dunnette_et_al_2014\CH10_charcoal\'</span>;
workingDir2 = <span class="string">'L:\4_archivedData\Dunnette_et_al_2014\CH10_MS\'</span>;
</pre><h2>Load data and create variables<a name="3"></a></h2><pre class="codeinput">cd(workingDir)      <span class="comment">% Change to working directory</span>
charData = csvread(<span class="string">'CH10_charResults.csv'</span>,1,0);
cd(workingDir2)      <span class="comment">% Change to working directory</span>
msData = csvread(<span class="string">'CH10_MS_charResults.csv'</span>,1,0);

cd(startDir)        <span class="comment">% Change directory back to starting directory.</span>
</pre><h2>Define variables from charcoal data<a name="4"></a></h2><pre class="codeinput">ageTop_i = charData(:,2);       <span class="comment">% [cal yr BP] Interpolated age (10 yr)</span>
C_acc = charData(:,6);          <span class="comment">% [# cm^-2 yr^-1] CHAR (10 yr int)</span>
C_back = charData(:,7);         <span class="comment">% [# cm^-2 yr^-1] Background charcoal</span>
C_peak = charData(:,8);         <span class="comment">% [# cm^-2 yr^-1] Charcoal peak series</span>
charThresh = charData(:,12);    <span class="comment">% [# cm^-2 yr^-1] Threshold for peak ID</span>
char_peaks = charData(:,19);    <span class="comment">% Index for charcoal peaks</span>
</pre><h2>Define variables from MS data<a name="5"></a></h2><pre class="codeinput">ageTop_i_MS = msData(:,2);      <span class="comment">% [cal yr BP] Interpolated age (10 yr)</span>
MS_peak = msData(:,8);          <span class="comment">% [SI] MS peak series</span>
MSThresh= msData(:,12);         <span class="comment">% [SI] Threshold for peak ID</span>
MS_peaks = msData(:,19);        <span class="comment">% Index for MS peaks.</span>
</pre><h2>Define "high severity catchment fires" (HSCF)<a name="6"></a></h2><p>Identify HSCF as any charcoal peak that is proceeded by an MS peak with 10 yr (1 sample) or is followed by a MS peak within 20 yr (2 samples).</p><pre class="codeinput">HSCF = zeros(size(char_peaks));         <span class="comment">% Space for identifying HSCF</span>
char_peak_in = find(char_peaks &gt; 0);    <span class="comment">% Index for charcoal peaks</span>

<span class="keyword">for</span> i = 1:length(char_peak_in)      <span class="comment">% For each charcoal peak...</span>
    in = char_peak_in(i);           <span class="comment">% Find the index for char peak i</span>
    <span class="keyword">if</span> sum(MS_peaks(in-2:in+1)) &gt; 0 <span class="comment">% If there is a MS peak with in +1 or</span>
                                    <span class="comment">% -2 samples, then define HSCF as 1.</span>
        HSCF(in) = 1;
    <span class="keyword">end</span>
<span class="keyword">end</span>
HSCF_in = find(HSCF &gt; 0);   <span class="comment">% Index for HSCF</span>
</pre><h2>Create Figure<a name="7"></a></h2><pre class="codeinput">figure(3); clf;
set(gcf,<span class="string">'color'</span>,<span class="string">'w'</span>,<span class="string">'units'</span>,<span class="string">'centimeters'</span>,<span class="string">'position'</span>,[5 0 12.35 23.35]);
H = 1.05;           <span class="comment">% Adjust to alter vertical space between subplots.</span>
x_lim = [-60 4250]; <span class="comment">% x-axis limits for all plots.</span>

<span class="comment">%%%% Pannel (a) - C_interp and C_back time series</span>
subplot(3,1,1)
yMin = min(C_acc);
yMax = max(C_acc)*0.05;
bar(ageTop_i,C_acc,1,<span class="string">'k'</span>)
hold <span class="string">on</span>
plot(ageTop_i,C_back,<span class="string">'color'</span>,[0.75 0.75 0.75],<span class="string">'linewidth'</span>,2);
ylim([yMin yMax]);
xlim(x_lim)
ylabel(<span class="string">'CHAR (# cm^{-2} yr^{-1})'</span>,<span class="string">'FontSize'</span>,9,<span class="string">'FontWeight'</span>,<span class="string">'b'</span>)
set(gca,<span class="string">'xtick'</span>,[0:500:x_lim(2)],<span class="string">'ytick'</span>,[0:3:6],<span class="string">'FontSize'</span>,9,<span class="keyword">...</span>
    <span class="string">'FontWeight'</span>,<span class="string">'b'</span>,<span class="string">'TickDir'</span>,<span class="string">'out'</span>,<span class="string">'Xticklabel'</span>,[],<span class="string">'XDir'</span>,<span class="string">'reverse'</span>,<span class="keyword">...</span>
    <span class="string">'box'</span>,<span class="string">'off'</span>);
p = get(gca,<span class="string">'pos'</span>);
p(4) = p(4)*H;
set(gca,<span class="string">'pos'</span>,p);
text(4000,yMax*1.1,<span class="string">'a'</span>,<span class="string">'fontweight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,12)

<span class="comment">%%%% Pannel (b)</span>
subplot(3,1,2)
yMin =  min(C_peak)*1.10;
yMax = max(C_peak)*0.1;

bar(ageTop_i,C_peak,1,<span class="string">'k'</span>);
hold <span class="string">on</span>
plot(ageTop_i(char_peaks &gt; 0),0.999*yMax,<span class="string">'ro'</span>,<span class="string">'markersize'</span>,4,<span class="keyword">...</span>
    <span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>)
plot(ageTop_i,charThresh,<span class="string">'color'</span>,<span class="string">'r'</span>,<span class="string">'LineWidth'</span>,2);
ylabel(<span class="string">'CHAR (# cm^{-2} yr^{-1})'</span>,<span class="string">'FontSize'</span>,9,<span class="string">'FontWeight'</span>,<span class="string">'b'</span>);
set(gca,<span class="string">'FontSize'</span>,9,<span class="string">'FontWeight'</span>,<span class="string">'b'</span>,<span class="string">'XDir'</span>,<span class="string">'reverse'</span>,<span class="string">'XTicklabel'</span>,[],<span class="keyword">...</span>
    <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="string">'TickDir'</span>,<span class="string">'out'</span>,<span class="string">'ytick'</span>,[0:5:10],<span class="string">'xlim'</span>,x_lim,<span class="string">'ylim'</span>,<span class="keyword">...</span>
    [yMin yMax])
p = get(gca,<span class="string">'pos'</span>);
p(4) = p(4)*H;
set(gca,<span class="string">'pos'</span>,p);
text(4000,yMax*1.1,<span class="string">'b'</span>,<span class="string">'fontweight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,12)

<span class="comment">%%%% Pannel (c)</span>
subplot(3,1,3);
yMin = min(MS_peak(5:end-5)*1.10);
yMax = max(MS_peak(5:end-5))*0.3;

f = bar(ageTop_i_MS,MS_peak,1);
set(f,<span class="string">'facecolor'</span>,[0.65 0.65 0.65],<span class="string">'edgecolor'</span>,[0.65 0.65 0.65])
hold <span class="string">on</span>
plot(ageTop_i_MS,MSThresh,<span class="string">'color'</span>,<span class="string">'r'</span>,<span class="string">'LineWidth'</span>,2)
plot(ageTop_i_MS(MS_peaks &gt; 0),yMax,<span class="string">'ok'</span>,<span class="string">'markersize'</span>,8,<span class="keyword">...</span>
    <span class="string">'MarkerFaceColor'</span>,[0.5 0.5 0.5],<span class="string">'MarkerEdgeColor'</span>,[0.25 0.25 0.25]);
plot(ageTop_i(HSCF_in),yMax,<span class="string">'ro'</span>,<span class="string">'markersize'</span>,4,<span class="keyword">...</span>
    <span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>);
set(gca,<span class="string">'XDir'</span>,<span class="string">'reverse'</span>,<span class="string">'FontSize'</span>,9,<span class="string">'FontWeight'</span>,<span class="string">'b'</span>,<span class="string">'ylim'</span>,<span class="keyword">...</span>
    [yMin yMax],<span class="string">'ytick'</span>,10^-5.*[0 2 4],<span class="string">'yticklabel'</span>,[0 2 4],<span class="string">'TickDir'</span>,<span class="keyword">...</span>
    <span class="string">'out'</span>,<span class="string">'box'</span>, <span class="string">'off'</span>,<span class="string">'xlim'</span>,x_lim);
ylabel(<span class="string">'MS (SI x10^{-5})'</span>,<span class="string">'fontsize'</span>,9,<span class="string">'fontweight'</span>,<span class="string">'b'</span>);
xlabel(<span class="string">'Calibrated years BP'</span>,<span class="string">'FontSize'</span>,9,<span class="string">'FontWeight'</span>,<span class="string">'b'</span>);
p = get(gca,<span class="string">'pos'</span>);
p(4) = p(4)*H;
set(gca,<span class="string">'pos'</span>,p);
text(4000,yMax*1.1,<span class="string">'c'</span>,<span class="string">'fontweight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,12)
</pre><img vspace="5" hspace="5" src="Fig_3_script_01.png" alt=""> <p class="footer"><br>
      Published with MATLAB&reg; 7.11<br></p></div><!--
##### SOURCE BEGIN #####
%% Fig_3_script.m
%
% Make Figure 3 from:
%   Dunnette P.V., P.E. Higuera, K.K. McLauchlan, K.M. Derr, C.E. Briles, 
%   M.H. Keefe. 2014. Biogeochemical impacts of wildfires over four 
%   millennia in a Rocky Mountain subalpine watershed. 
%   New Phytologist Accepted.
%
% Figure 3. Sediment charcoal and magnetic susceptibility (MS) records. 
% (a) Charcoal accumulation rate (CHAR, black line), interpolated to 
% 10-year intervals, and the 500-year trend (gray line), representing 
% “background” CHAR. (b) Residual CHAR values (black line), the threshold
% used to identify potential fire events (red line), and CHAR values 
% this threshold and thus identified as local fire events (red dots).
% (c) Residual MS values (gray line), the threshold used to identify MS 
% peaks (red line), MS values exceeding the threshold and thus identified
% as MS peaks (grey circles), with coincident CHAR and MS peaks identified
% as high-severity catchment fires (grey circles with red dots). 
%
% FILE REQUIREMENTS:
%   (1) CH10_MS_charResults.csv REPLACE_WITH_DASH_DASH results from CharAnalysis
%   (2) CH10_charResults.csv REPLACE_WITH_DASH_DASH results form CharAnalysis, run with MS data
%
% DEPENDENCIES: 
%   NONE
%
% CITATION, FILES, AND SELF-AUTHORED FUNCTIONS AVAILABLE FROM FigShare
%   Higuera, P.E. and P.V. Dunnette. 2014. Data, code, and 
%   figures from Dunnette et al. 2014. figshare. 
%   http://dx.doi.org/10.6084/m9.figshare.988687
%
% Created by: P.V. Dunnette
% Created on: December 2012
% Updated: 2/2013; 7/2013; 8/2013; 9/2013; 11/2013; 1/2014 by PVD
% Edited: 4/2014 for publication, by P.E. Higuera.
%
% University of Idaho, PaleoEcology and Fire Ecology Lab
% http://www.uidaho.edu/cnr/paleoecologylab
% phiguera@uidaho.edu
clear all
 
%% Set working directories: directories where input data are located
%%%% IF ALL FILES ARE LOCATED IN THE SAME DIRECTORY AS THIS SCRIPT, CHANGE
%%%% workdingDir to 'pwd'
startDir = pwd;     % Record starting path
workingDir = 'L:\4_archivedData\Dunnette_et_al_2014\CH10_charcoal\';
workingDir2 = 'L:\4_archivedData\Dunnette_et_al_2014\CH10_MS\';
 
%% Load data and create variables
cd(workingDir)      % Change to working directory
charData = csvread('CH10_charResults.csv',1,0);
cd(workingDir2)      % Change to working directory
msData = csvread('CH10_MS_charResults.csv',1,0);
 
cd(startDir)        % Change directory back to starting directory.
 
%% Define variables from charcoal data
ageTop_i = charData(:,2);       % [cal yr BP] Interpolated age (10 yr)
C_acc = charData(:,6);          % [# cm^-2 yr^-1] CHAR (10 yr int)
C_back = charData(:,7);         % [# cm^-2 yr^-1] Background charcoal 
C_peak = charData(:,8);         % [# cm^-2 yr^-1] Charcoal peak series 
charThresh = charData(:,12);    % [# cm^-2 yr^-1] Threshold for peak ID
char_peaks = charData(:,19);    % Index for charcoal peaks
 
%% Define variables from MS data
ageTop_i_MS = msData(:,2);      % [cal yr BP] Interpolated age (10 yr)
MS_peak = msData(:,8);          % [SI] MS peak series
MSThresh= msData(:,12);         % [SI] Threshold for peak ID
MS_peaks = msData(:,19);        % Index for MS peaks.
 
%% Define "high severity catchment fires" (HSCF)
% Identify HSCF as any charcoal peak that is proceeded by an MS peak with 
% 10 yr (1 sample) or is followed by a MS peak within 20 yr (2 samples).
 
HSCF = zeros(size(char_peaks));         % Space for identifying HSCF
char_peak_in = find(char_peaks > 0);    % Index for charcoal peaks
 
for i = 1:length(char_peak_in)      % For each charcoal peak...
    in = char_peak_in(i);           % Find the index for char peak i
    if sum(MS_peaks(in-2:in+1)) > 0 % If there is a MS peak with in +1 or
                                    % -2 samples, then define HSCF as 1.  
        HSCF(in) = 1;
    end
end
HSCF_in = find(HSCF > 0);   % Index for HSCF
 
%% Create Figure
figure(3); clf; 
set(gcf,'color','w','units','centimeters','position',[5 0 12.35 23.35]); 
H = 1.05;           % Adjust to alter vertical space between subplots. 
x_lim = [-60 4250]; % x-axis limits for all plots. 
 
%%%% Pannel (a) - C_interp and C_back time series
subplot(3,1,1)
yMin = min(C_acc);
yMax = max(C_acc)*0.05;
bar(ageTop_i,C_acc,1,'k')
hold on
plot(ageTop_i,C_back,'color',[0.75 0.75 0.75],'linewidth',2);
ylim([yMin yMax]);
xlim(x_lim)
ylabel('CHAR (# cm^{-2} yr^{-1})','FontSize',9,'FontWeight','b')
set(gca,'xtick',[0:500:x_lim(2)],'ytick',[0:3:6],'FontSize',9,...
    'FontWeight','b','TickDir','out','Xticklabel',[],'XDir','reverse',...
    'box','off');
p = get(gca,'pos'); 
p(4) = p(4)*H;
set(gca,'pos',p);
text(4000,yMax*1.1,'a','fontweight','bold','FontSize',12)
 
%%%% Pannel (b)
subplot(3,1,2)
yMin =  min(C_peak)*1.10; 
yMax = max(C_peak)*0.1;
 
bar(ageTop_i,C_peak,1,'k');
hold on
plot(ageTop_i(char_peaks > 0),0.999*yMax,'ro','markersize',4,...
    'MarkerFaceColor','r') 
plot(ageTop_i,charThresh,'color','r','LineWidth',2); 
ylabel('CHAR (# cm^{-2} yr^{-1})','FontSize',9,'FontWeight','b');
set(gca,'FontSize',9,'FontWeight','b','XDir','reverse','XTicklabel',[],...
    'box','off','TickDir','out','ytick',[0:5:10],'xlim',x_lim,'ylim',...
    [yMin yMax])
p = get(gca,'pos'); 
p(4) = p(4)*H;
set(gca,'pos',p);
text(4000,yMax*1.1,'b','fontweight','bold','FontSize',12)
 
%%%% Pannel (c)
subplot(3,1,3);
yMin = min(MS_peak(5:end-5)*1.10);
yMax = max(MS_peak(5:end-5))*0.3;
 
f = bar(ageTop_i_MS,MS_peak,1);
set(f,'facecolor',[0.65 0.65 0.65],'edgecolor',[0.65 0.65 0.65])
hold on
plot(ageTop_i_MS,MSThresh,'color','r','LineWidth',2) 
plot(ageTop_i_MS(MS_peaks > 0),yMax,'ok','markersize',8,...
    'MarkerFaceColor',[0.5 0.5 0.5],'MarkerEdgeColor',[0.25 0.25 0.25]); 
plot(ageTop_i(HSCF_in),yMax,'ro','markersize',4,...
    'MarkerFaceColor','r'); 
set(gca,'XDir','reverse','FontSize',9,'FontWeight','b','ylim',...
    [yMin yMax],'ytick',10^-5.*[0 2 4],'yticklabel',[0 2 4],'TickDir',...
    'out','box', 'off','xlim',x_lim);
ylabel('MS (SI x10^{-5})','fontsize',9,'fontweight','b');  
xlabel('Calibrated years BP','FontSize',9,'FontWeight','b');
p = get(gca,'pos'); 
p(4) = p(4)*H;
set(gca,'pos',p);
text(4000,yMax*1.1,'c','fontweight','bold','FontSize',12)

##### SOURCE END #####
--></body></html>